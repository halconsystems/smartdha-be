2026-01-18 22:49:13.409 +05:00 [ERR] An error occurred while initialising the database.
Microsoft.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)
 ---> System.ComponentModel.Win32Exception (53): The network path was not found.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, SqlCommand command, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, TimeoutTimer timeout, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool, Func`3 accessTokenCallback)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerDatabaseCreator.<>c__DisplayClass20_0.<<ExistsAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at DHAFacilitationAPIs.Infrastructure.Data.ApplicationDbContextInitialiser.InitialiseAsync() in C:\Users\muhammad.moiz\source\repos\DHAFacilitationAPIs\src\Infrastructure\Data\ApplicationDbContextInitialiser.cs:line 48
ClientConnectionId:00000000-0000-0000-0000-000000000000
Error Number:53,State:0,Class:20
2026-01-18 22:50:10.925 +05:00 [INF] [CQRS]
TraceId  : 0HNIMN7PFAIR6:00000001
Request  : AppUserLoginCommand
Duration : 855 ms
2026-01-18 22:50:11.028 +05:00 [WRN] CMS Long Running Request: AppUserLoginCommand (931 milliseconds) a02644dd-a143-4d47-8e5e-704c1658c31f 4220199802729 {"CNIC":"4220199802729","Password":"P@ssword1","$type":"AppUserLoginCommand"}
2026-01-18 22:50:11.087 +05:00 [INF] ================ HTTP REQUEST =================
TraceId  : 0HNIMN7PFAIR6:00000001
Method   : POST
Path     : /api/auth/login
Status   : 200
Duration : 1442 ms
IP       : ::1

Request:
{
  "cnic": "***",
  "password": "***"
}

Response:
{"status":200,"title":"Login successful!","detail":"Authentication step completed.","data":{"name":"Muhammad Moiz","isOtpRequired":false,"accessToken":"***","responseMessage":"Login successful. You are now signed in without OTP verification.","mobileNumber":"***"}}
==============================================
2026-01-18 22:53:58.835 +05:00 [ERR] Failed executing DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [ServiceProcess] ADD [Instruction] nvarchar(max) NULL;
2026-01-18 23:03:01.147 +05:00 [ERR] Failed executing DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ShopDrivers] (
    [Ser] int NOT NULL IDENTITY,
    [Id] uniqueidentifier NOT NULL,
    [ShopId] uniqueidentifier NOT NULL,
    [ShopsId] uniqueidentifier NULL,
    [DriverId] uniqueidentifier NOT NULL,
    [DriverUserId] nvarchar(450) NULL,
    [Created] datetime2 NOT NULL,
    [CreatedBy] nvarchar(max) NULL,
    [LastModified] datetime2 NOT NULL,
    [LastModifiedBy] nvarchar(max) NULL,
    [IsDeleted] bit NULL,
    [IsActive] bit NULL,
    CONSTRAINT [PK_ShopDrivers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ShopDrivers_ApplicationUser_DriverUserId] FOREIGN KEY ([DriverUserId]) REFERENCES [ApplicationUser] ([Id]),
    CONSTRAINT [FK_ShopDrivers_Shops_ShopsId] FOREIGN KEY ([ShopsId]) REFERENCES [Shops] ([Id])
);
2026-01-18 23:31:54.477 +05:00 [ERR] Failed executing DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [OrderDispatches] (
    [Ser] int NOT NULL IDENTITY,
    [Id] uniqueidentifier NOT NULL,
    [OrderId] uniqueidentifier NOT NULL,
    [OrdersId] uniqueidentifier NOT NULL,
    [DeliverVehicleId] uniqueidentifier NOT NULL,
    [DeliverShopVehiclesId] uniqueidentifier NOT NULL,
    [PickupVehicleId] uniqueidentifier NOT NULL,
    [PickupShopVehiclesId] uniqueidentifier NOT NULL,
    [Status] int NOT NULL,
    [PickUpAssignedAt] datetime2 NOT NULL,
    [DeliveredAssignedAt] datetime2 NOT NULL,
    [PickupAssignedByUserId] uniqueidentifier NULL,
    [PickUpByUserId] nvarchar(450) NULL,
    [PickupDriverId] uniqueidentifier NULL,
    [DeliverAssignedByUserId] uniqueidentifier NULL,
    [DeliverByUserId] nvarchar(450) NULL,
    [DeliverDriverId] uniqueidentifier NULL,
    [IsPickup] bit NOT NULL,
    [IsDelivered] bit NOT NULL,
    [OrderRemarks] nvarchar(max) NULL,
    [AcceptedAtLatitude] float NULL,
    [AcceptedAtLongitude] float NULL,
    [AcceptedAtAddress] nvarchar(300) NULL,
    [DistanceFromOrderKm] float NULL,
    [LastLocationUpdateAt] datetime2 NULL,
    [Created] datetime2 NOT NULL,
    [CreatedBy] nvarchar(max) NULL,
    [LastModified] datetime2 NOT NULL,
    [LastModifiedBy] nvarchar(max) NULL,
    [IsDeleted] bit NULL,
    [IsActive] bit NULL,
    CONSTRAINT [PK_OrderDispatches] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_OrderDispatches_Orders_OrdersId] FOREIGN KEY ([OrdersId]) REFERENCES [Orders] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_OrderDispatches_ShopVehicles_DeliverShopVehiclesId] FOREIGN KEY ([DeliverShopVehiclesId]) REFERENCES [ShopVehicles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_OrderDispatches_ShopVehicles_PickupShopVehiclesId] FOREIGN KEY ([PickupShopVehiclesId]) REFERENCES [ShopVehicles] ([Id]) ON DELETE CASCADE
);
2026-01-18 23:35:19.391 +05:00 [ERR] Failed executing DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [OrderDispatches] DROP CONSTRAINT [FK_OrderDispatches_ApplicationUser_DeliverByUserId];
2026-01-18 23:36:36.550 +05:00 [ERR] Failed executing DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [OrderDispatches] DROP CONSTRAINT [FK_OrderDispatches_ApplicationUser_PickUpByUserId];
